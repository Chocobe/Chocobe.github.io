(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[513],{2576:function(e,t,o){Promise.resolve().then(o.bind(o,9857))},9857:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return HauntedHouse_HauntedHouse}});var n=o(230),a=o(7437),i=o(2265),r=o(6375);let s={type:"change"},l={type:"start"},c={type:"end"},h=new r.zHn,u=new r.JOQ,d=Math.cos(70*r.M8C.DEG2RAD);let OrbitControls=class OrbitControls extends r.pBf{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new r.Pa4,this.cursor=new r.Pa4,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:r.RsA.ROTATE,MIDDLE:r.RsA.DOLLY,RIGHT:r.RsA.PAN},this.touches={ONE:r.QmN.ROTATE,TWO:r.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return p.phi},this.getAzimuthalAngle=function(){return p.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",onKeyDown),this._domElementKeyEvents=e},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",onKeyDown),this._domElementKeyEvents=null},this.saveState=function(){o.target0.copy(o.target),o.position0.copy(o.object.position),o.zoom0=o.object.zoom},this.reset=function(){o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.zoom=o.zoom0,o.object.updateProjectionMatrix(),o.dispatchEvent(s),o.update(),a=n.NONE},this.update=function(){let t=new r.Pa4,l=new r._fP().setFromUnitVectors(e.up,new r.Pa4(0,1,0)),c=l.clone().invert(),_=new r.Pa4,v=new r._fP,y=new r.Pa4,b=2*Math.PI;return function(w=null){let M=o.object.position;t.copy(M).sub(o.target),t.applyQuaternion(l),p.setFromVector3(t),o.autoRotate&&a===n.NONE&&rotateLeft(getAutoRotationAngle(w)),o.enableDamping?(p.theta+=m.theta*o.dampingFactor,p.phi+=m.phi*o.dampingFactor):(p.theta+=m.theta,p.phi+=m.phi);let P=o.minAzimuthAngle,x=o.maxAzimuthAngle;isFinite(P)&&isFinite(x)&&(P<-Math.PI?P+=b:P>Math.PI&&(P-=b),x<-Math.PI?x+=b:x>Math.PI&&(x-=b),P<=x?p.theta=Math.max(P,Math.min(x,p.theta)):p.theta=p.theta>(P+x)/2?Math.max(P,p.theta):Math.min(x,p.theta)),p.phi=Math.max(o.minPolarAngle,Math.min(o.maxPolarAngle,p.phi)),p.makeSafe(),!0===o.enableDamping?o.target.addScaledVector(f,o.dampingFactor):o.target.add(f),o.target.sub(o.cursor),o.target.clampLength(o.minTargetRadius,o.maxTargetRadius),o.target.add(o.cursor);let E=!1;if(o.zoomToCursor&&k||o.object.isOrthographicCamera)p.radius=clampDistance(p.radius);else{let e=p.radius;p.radius=clampDistance(p.radius*g),E=e!=p.radius}if(t.setFromSpherical(p),t.applyQuaternion(c),M.copy(o.target).add(t),o.object.lookAt(o.target),!0===o.enableDamping?(m.theta*=1-o.dampingFactor,m.phi*=1-o.dampingFactor,f.multiplyScalar(1-o.dampingFactor)):(m.set(0,0,0),f.set(0,0,0)),o.zoomToCursor&&k){let n=null;if(o.object.isPerspectiveCamera){let e=t.length();n=clampDistance(e*g);let a=e-n;o.object.position.addScaledVector(T,a),o.object.updateMatrixWorld(),E=!!a}else if(o.object.isOrthographicCamera){let e=new r.Pa4(j.x,j.y,0);e.unproject(o.object);let a=o.object.zoom;o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/g)),o.object.updateProjectionMatrix(),E=a!==o.object.zoom;let i=new r.Pa4(j.x,j.y,0);i.unproject(o.object),o.object.position.sub(i).add(e),o.object.updateMatrixWorld(),n=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),o.zoomToCursor=!1;null!==n&&(this.screenSpacePanning?o.target.set(0,0,-1).transformDirection(o.object.matrix).multiplyScalar(n).add(o.object.position):(h.origin.copy(o.object.position),h.direction.set(0,0,-1).transformDirection(o.object.matrix),Math.abs(o.object.up.dot(h.direction))<d?e.lookAt(o.target):(u.setFromNormalAndCoplanarPoint(o.object.up,o.target),h.intersectPlane(u,o.target))))}else if(o.object.isOrthographicCamera){let e=o.object.zoom;o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/g)),e!==o.object.zoom&&(o.object.updateProjectionMatrix(),E=!0)}return g=1,k=!1,!!(E||_.distanceToSquared(o.object.position)>i||8*(1-v.dot(o.object.quaternion))>i||y.distanceToSquared(o.target)>i)&&(o.dispatchEvent(s),_.copy(o.object.position),v.copy(o.object.quaternion),y.copy(o.target),!0)}}(),this.dispose=function(){o.domElement.removeEventListener("contextmenu",onContextMenu),o.domElement.removeEventListener("pointerdown",onPointerDown),o.domElement.removeEventListener("pointercancel",onPointerUp),o.domElement.removeEventListener("wheel",onMouseWheel),o.domElement.removeEventListener("pointermove",onPointerMove),o.domElement.removeEventListener("pointerup",onPointerUp);let e=o.domElement.getRootNode();e.removeEventListener("keydown",interceptControlDown,{capture:!0}),null!==o._domElementKeyEvents&&(o._domElementKeyEvents.removeEventListener("keydown",onKeyDown),o._domElementKeyEvents=null)};let o=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},a=n.NONE,i=1e-6,p=new r.$V,m=new r.$V,g=1,f=new r.Pa4,_=new r.FM8,v=new r.FM8,y=new r.FM8,b=new r.FM8,w=new r.FM8,M=new r.FM8,P=new r.FM8,x=new r.FM8,E=new r.FM8,T=new r.Pa4,j=new r.FM8,k=!1,S=[],R={},L=!1;function getAutoRotationAngle(e){return null!==e?2*Math.PI/60*o.autoRotateSpeed*e:2*Math.PI/60/60*o.autoRotateSpeed}function getZoomScale(e){return Math.pow(.95,o.zoomSpeed*Math.abs(.01*e))}function rotateLeft(e){m.theta-=e}function rotateUp(e){m.phi-=e}let D=function(){let e=new r.Pa4;return function(t,o){e.setFromMatrixColumn(o,0),e.multiplyScalar(-t),f.add(e)}}(),O=function(){let e=new r.Pa4;return function(t,n){!0===o.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(o.object.up,e)),e.multiplyScalar(t),f.add(e)}}(),A=function(){let e=new r.Pa4;return function(t,n){let a=o.domElement;if(o.object.isPerspectiveCamera){let i=o.object.position;e.copy(i).sub(o.target);let r=e.length();D(2*t*(r*=Math.tan(o.object.fov/2*Math.PI/180))/a.clientHeight,o.object.matrix),O(2*n*r/a.clientHeight,o.object.matrix)}else o.object.isOrthographicCamera?(D(t*(o.object.right-o.object.left)/o.object.zoom/a.clientWidth,o.object.matrix),O(n*(o.object.top-o.object.bottom)/o.object.zoom/a.clientHeight,o.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),o.enablePan=!1)}}();function dollyOut(e){o.object.isPerspectiveCamera||o.object.isOrthographicCamera?g/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function dollyIn(e){o.object.isPerspectiveCamera||o.object.isOrthographicCamera?g*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function updateZoomParameters(e,t){if(!o.zoomToCursor)return;k=!0;let n=o.domElement.getBoundingClientRect(),a=e-n.left,i=t-n.top,r=n.width,s=n.height;j.x=a/r*2-1,j.y=-(2*(i/s))+1,T.set(j.x,j.y,1).unproject(o.object).sub(o.object.position).normalize()}function clampDistance(e){return Math.max(o.minDistance,Math.min(o.maxDistance,e))}function handleMouseDownRotate(e){_.set(e.clientX,e.clientY)}function handleMouseDownDolly(e){updateZoomParameters(e.clientX,e.clientX),P.set(e.clientX,e.clientY)}function handleMouseDownPan(e){b.set(e.clientX,e.clientY)}function handleMouseMoveRotate(e){v.set(e.clientX,e.clientY),y.subVectors(v,_).multiplyScalar(o.rotateSpeed);let t=o.domElement;rotateLeft(2*Math.PI*y.x/t.clientHeight),rotateUp(2*Math.PI*y.y/t.clientHeight),_.copy(v),o.update()}function handleMouseMoveDolly(e){x.set(e.clientX,e.clientY),E.subVectors(x,P),E.y>0?dollyOut(getZoomScale(E.y)):E.y<0&&dollyIn(getZoomScale(E.y)),P.copy(x),o.update()}function handleMouseMovePan(e){w.set(e.clientX,e.clientY),M.subVectors(w,b).multiplyScalar(o.panSpeed),A(M.x,M.y),b.copy(w),o.update()}function handleMouseWheel(e){updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?dollyIn(getZoomScale(e.deltaY)):e.deltaY>0&&dollyOut(getZoomScale(e.deltaY)),o.update()}function handleKeyDown(e){let t=!1;switch(e.code){case o.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?rotateUp(2*Math.PI*o.rotateSpeed/o.domElement.clientHeight):A(0,o.keyPanSpeed),t=!0;break;case o.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?rotateUp(-2*Math.PI*o.rotateSpeed/o.domElement.clientHeight):A(0,-o.keyPanSpeed),t=!0;break;case o.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?rotateLeft(2*Math.PI*o.rotateSpeed/o.domElement.clientHeight):A(o.keyPanSpeed,0),t=!0;break;case o.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?rotateLeft(-2*Math.PI*o.rotateSpeed/o.domElement.clientHeight):A(-o.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),o.update())}function handleTouchStartRotate(e){if(1===S.length)_.set(e.pageX,e.pageY);else{let t=getSecondPointerPosition(e),o=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);_.set(o,n)}}function handleTouchStartPan(e){if(1===S.length)b.set(e.pageX,e.pageY);else{let t=getSecondPointerPosition(e),o=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);b.set(o,n)}}function handleTouchStartDolly(e){let t=getSecondPointerPosition(e),o=e.pageX-t.x,n=e.pageY-t.y;P.set(0,Math.sqrt(o*o+n*n))}function handleTouchStartDollyPan(e){o.enableZoom&&handleTouchStartDolly(e),o.enablePan&&handleTouchStartPan(e)}function handleTouchStartDollyRotate(e){o.enableZoom&&handleTouchStartDolly(e),o.enableRotate&&handleTouchStartRotate(e)}function handleTouchMoveRotate(e){if(1==S.length)v.set(e.pageX,e.pageY);else{let t=getSecondPointerPosition(e),o=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);v.set(o,n)}y.subVectors(v,_).multiplyScalar(o.rotateSpeed);let t=o.domElement;rotateLeft(2*Math.PI*y.x/t.clientHeight),rotateUp(2*Math.PI*y.y/t.clientHeight),_.copy(v)}function handleTouchMovePan(e){if(1===S.length)w.set(e.pageX,e.pageY);else{let t=getSecondPointerPosition(e),o=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);w.set(o,n)}M.subVectors(w,b).multiplyScalar(o.panSpeed),A(M.x,M.y),b.copy(w)}function handleTouchMoveDolly(e){let t=getSecondPointerPosition(e),n=e.pageX-t.x,a=e.pageY-t.y;x.set(0,Math.sqrt(n*n+a*a)),E.set(0,Math.pow(x.y/P.y,o.zoomSpeed)),dollyOut(E.y),P.copy(x);let i=(e.pageX+t.x)*.5,r=(e.pageY+t.y)*.5;updateZoomParameters(i,r)}function handleTouchMoveDollyPan(e){o.enableZoom&&handleTouchMoveDolly(e),o.enablePan&&handleTouchMovePan(e)}function handleTouchMoveDollyRotate(e){o.enableZoom&&handleTouchMoveDolly(e),o.enableRotate&&handleTouchMoveRotate(e)}function onPointerDown(e){!1!==o.enabled&&(0===S.length&&(o.domElement.setPointerCapture(e.pointerId),o.domElement.addEventListener("pointermove",onPointerMove),o.domElement.addEventListener("pointerup",onPointerUp)),isTrackingPointer(e)||(addPointer(e),"touch"===e.pointerType?onTouchStart(e):onMouseDown(e)))}function onPointerMove(e){!1!==o.enabled&&("touch"===e.pointerType?onTouchMove(e):onMouseMove(e))}function onPointerUp(e){switch(removePointer(e),S.length){case 0:o.domElement.releasePointerCapture(e.pointerId),o.domElement.removeEventListener("pointermove",onPointerMove),o.domElement.removeEventListener("pointerup",onPointerUp),o.dispatchEvent(c),a=n.NONE;break;case 1:let t=S[0],i=R[t];onTouchStart({pointerId:t,pageX:i.x,pageY:i.y})}}function onMouseDown(e){let t;switch(e.button){case 0:t=o.mouseButtons.LEFT;break;case 1:t=o.mouseButtons.MIDDLE;break;case 2:t=o.mouseButtons.RIGHT;break;default:t=-1}switch(t){case r.RsA.DOLLY:if(!1===o.enableZoom)return;handleMouseDownDolly(e),a=n.DOLLY;break;case r.RsA.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===o.enablePan)return;handleMouseDownPan(e),a=n.PAN}else{if(!1===o.enableRotate)return;handleMouseDownRotate(e),a=n.ROTATE}break;case r.RsA.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===o.enableRotate)return;handleMouseDownRotate(e),a=n.ROTATE}else{if(!1===o.enablePan)return;handleMouseDownPan(e),a=n.PAN}break;default:a=n.NONE}a!==n.NONE&&o.dispatchEvent(l)}function onMouseMove(e){switch(a){case n.ROTATE:if(!1===o.enableRotate)return;handleMouseMoveRotate(e);break;case n.DOLLY:if(!1===o.enableZoom)return;handleMouseMoveDolly(e);break;case n.PAN:if(!1===o.enablePan)return;handleMouseMovePan(e)}}function onMouseWheel(e){!1!==o.enabled&&!1!==o.enableZoom&&a===n.NONE&&(e.preventDefault(),o.dispatchEvent(l),handleMouseWheel(customWheelEvent(e)),o.dispatchEvent(c))}function customWheelEvent(e){let t=e.deltaMode,o={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:o.deltaY*=16;break;case 2:o.deltaY*=100}return e.ctrlKey&&!L&&(o.deltaY*=10),o}function interceptControlDown(e){if("Control"===e.key){L=!0;let e=o.domElement.getRootNode();e.addEventListener("keyup",interceptControlUp,{passive:!0,capture:!0})}}function interceptControlUp(e){if("Control"===e.key){L=!1;let e=o.domElement.getRootNode();e.removeEventListener("keyup",interceptControlUp,{passive:!0,capture:!0})}}function onKeyDown(e){!1!==o.enabled&&!1!==o.enablePan&&handleKeyDown(e)}function onTouchStart(e){switch(trackPointer(e),S.length){case 1:switch(o.touches.ONE){case r.QmN.ROTATE:if(!1===o.enableRotate)return;handleTouchStartRotate(e),a=n.TOUCH_ROTATE;break;case r.QmN.PAN:if(!1===o.enablePan)return;handleTouchStartPan(e),a=n.TOUCH_PAN;break;default:a=n.NONE}break;case 2:switch(o.touches.TWO){case r.QmN.DOLLY_PAN:if(!1===o.enableZoom&&!1===o.enablePan)return;handleTouchStartDollyPan(e),a=n.TOUCH_DOLLY_PAN;break;case r.QmN.DOLLY_ROTATE:if(!1===o.enableZoom&&!1===o.enableRotate)return;handleTouchStartDollyRotate(e),a=n.TOUCH_DOLLY_ROTATE;break;default:a=n.NONE}break;default:a=n.NONE}a!==n.NONE&&o.dispatchEvent(l)}function onTouchMove(e){switch(trackPointer(e),a){case n.TOUCH_ROTATE:if(!1===o.enableRotate)return;handleTouchMoveRotate(e),o.update();break;case n.TOUCH_PAN:if(!1===o.enablePan)return;handleTouchMovePan(e),o.update();break;case n.TOUCH_DOLLY_PAN:if(!1===o.enableZoom&&!1===o.enablePan)return;handleTouchMoveDollyPan(e),o.update();break;case n.TOUCH_DOLLY_ROTATE:if(!1===o.enableZoom&&!1===o.enableRotate)return;handleTouchMoveDollyRotate(e),o.update();break;default:a=n.NONE}}function onContextMenu(e){!1!==o.enabled&&e.preventDefault()}function addPointer(e){S.push(e.pointerId)}function removePointer(e){delete R[e.pointerId];for(let t=0;t<S.length;t++)if(S[t]==e.pointerId){S.splice(t,1);return}}function isTrackingPointer(e){for(let t=0;t<S.length;t++)if(S[t]==e.pointerId)return!0;return!1}function trackPointer(e){let t=R[e.pointerId];void 0===t&&(t=new r.FM8,R[e.pointerId]=t),t.set(e.pageX,e.pageY)}function getSecondPointerPosition(e){let t=e.pointerId===S[0]?S[1]:S[0];return R[t]}o.domElement.addEventListener("contextmenu",onContextMenu),o.domElement.addEventListener("pointerdown",onPointerDown),o.domElement.addEventListener("pointercancel",onPointerUp),o.domElement.addEventListener("wheel",onMouseWheel,{passive:!1});let C=o.domElement.getRootNode();C.addEventListener("keydown",interceptControlDown,{passive:!0,capture:!0}),this.update()}};let Timer=class Timer{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=now(),this._delta=0,this._elapsed=0,this._timescale=1,this._usePageVisibilityAPI="undefined"!=typeof document&&void 0!==document.hidden,!0===this._usePageVisibilityAPI&&(this._pageVisibilityHandler=handleVisibilityChange.bind(this),document.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=now()-this._startTime,this}dispose(){return!0===this._usePageVisibilityAPI&&document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this}update(e){return!0===this._usePageVisibilityAPI&&!0===document.hidden?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(void 0!==e?e:now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}};function now(){return("undefined"==typeof performance?Date:performance).now()}function handleVisibilityChange(){!1===document.hidden&&this.reset()}let MainLight=class MainLight{_createAmbientLight(){let e=new r.Mig("#fff",.5);return e}_createDirectionalLight(){let e=new r.Ox3("#fff",3);return e.position.set(3,4,-10),e.castShadow=!0,e.shadow.camera.near=1,e.shadow.camera.far=20,e.shadow.camera.top=4,e.shadow.camera.right=9,e.shadow.camera.bottom=-4,e.shadow.camera.left=-9,e}get ambientLight(){return this._ambientLight}get directionalLight(){return this._directionalLight}constructor(){this._ambientLight=this._createAmbientLight(),this._directionalLight=this._createDirectionalLight()}};let Floor=class Floor{_createFloor(e){let t=new r._12(20,20,100,100),o=new r.Wid({transparent:!0,alphaMap:e.load("/threejs-practices/textures/textures/floor/floor_alpha.jpg"),map:e.load("/threejs-practices/textures/textures/floor/stony_dirt_path_1k/floor_diff_1k.jpg",e=>{e.colorSpace=r.KI_}),aoMap:e.load("/threejs-practices/textures/textures/floor/stony_dirt_path_1k/floor_arm_1k.jpg"),roughnessMap:e.load("/threejs-practices/textures/textures/floor/stony_dirt_path_1k/floor_arm_1k.jpg"),metalnessMap:e.load("/threejs-practices/textures/textures/floor/stony_dirt_path_1k/floor_arm_1k.jpg"),normalMap:e.load("/threejs-practices/textures/textures/floor/stony_dirt_path_1k/floor_nor_gl_1k.jpg"),displacementMap:e.load("/threejs-practices/textures/textures/floor/stony_dirt_path_1k/floor_disp_1k.jpg"),displacementScale:.5,displacementBias:-.25}),n=new r.Kj0(t,o);return n.receiveShadow=!0,n.rotation.x-=.5*Math.PI,n}get mesh(){return this._mesh}constructor(e){this._mesh=this._createFloor(e)}};let House=class House{_initWall(e){let t=new r.DvJ(4,2.5,4),o=new r.Wid({map:e.load("/threejs-practices/textures/textures/wall/rough_block_wall_1k/wall_diff_1k.jpg",this._onLoadColorTexture),aoMap:e.load("/threejs-practices/textures/textures/wall/rough_block_wall_1k/wall_arm_1k.jpg"),roughnessMap:e.load("/threejs-practices/textures/textures/wall/rough_block_wall_1k/wall_arm_1k.jpg"),metalnessMap:e.load("/threejs-practices/textures/textures/wall/rough_block_wall_1k/wall_arm_1k.jpg"),normalMap:e.load("/threejs-practices/textures/textures/wall/rough_block_wall_1k/wall_nor_gl_1k.jpg")}),n=new r.Kj0(t,o);n.castShadow=!0,n.receiveShadow=!0,this._group.add(n)}_initRoof(e){let t=new r.b_z(4,1.5,4),o=new r.Wid({color:"#6c5343",map:e.load("/threejs-practices/textures/textures/roof/clay_roof_tiles_03_1k/roof_diff_1k.jpg",e=>{this._onLoadColorTexture(e),this._onLoadRoofTexture(e)}),aoMap:e.load("/threejs-practices/textures/textures/roof/clay_roof_tiles_03_1k/roof_arm_1k.jpg",this._onLoadRoofTexture),roughnessMap:e.load("/threejs-practices/textures/textures/roof/clay_roof_tiles_03_1k/roof_arm_1k.jpg",this._onLoadRoofTexture),metalnessMap:e.load("/threejs-practices/textures/textures/roof/clay_roof_tiles_03_1k/roof_arm_1k.jpg",this._onLoadRoofTexture),normalMap:e.load("/threejs-practices/textures/textures/roof/clay_roof_tiles_03_1k/roof_nor_gl_1k.jpg",this._onLoadRoofTexture)}),n=new r.Kj0(t,o);n.castShadow=!0,n.position.set(0,2,0),n.rotation.y=.25*Math.PI,this._group.add(n)}_initDoor(e){let t=new r._12(2.5,2.5,100,100),o=new r.Wid({transparent:!0,alphaMap:e.load("/threejs-practices/textures/textures/door/door_alpha.jpg"),map:e.load("/threejs-practices/textures/textures/door/door_color.jpg",this._onLoadColorTexture),aoMap:e.load("/threejs-practices/textures/textures/door/door_ambientOcclusion.jpg"),roughnessMap:e.load("/threejs-practices/textures/textures/door/door_ambientOcclusion.jpg"),metalnessMap:e.load("/threejs-practices/textures/textures/door/door_metalness.jpg"),normalMap:e.load("/threejs-practices/textures/textures/door/door_normal.jpg"),displacementMap:e.load("/threejs-practices/textures/textures/door/door_height.jpg"),displacementScale:.1,displacementBias:-.02}),n=new r.Kj0(t,o);n.receiveShadow=!0,n.position.set(0,-.1,2.0001),this._group.add(n)}_createDoorLight(){let e=new r.cek("#fffe40",5);e.castShadow=!0,e.position.set(0,1.2,2.2),this._group.add(e)}_onLoadColorTexture(e){e.colorSpace=r.KI_}_onLoadRoofTexture(e){e.repeat.x=2.5,e.repeat.y=2.5,e.wrapS=r.rpg,e.wrapT=r.rpg}get mesh(){return this._group}constructor(e){this._group=new r.ZAu,this._initWall(e),this._initRoof(e),this._initDoor(e),this._createDoorLight()}};let Graves=class Graves{_createGeometry(){return new r.DvJ(.5,1,.25)}_createMaterial(e){return new r.Wid({map:e.load("/threejs-practices/textures/textures/grave/lichen_rock_1k/grave_diff_1k.jpg",e=>{e.colorSpace=r.KI_}),aoMap:e.load("/threejs-practices/textures/textures/grave/lichen_rock_1k/grave_arm_1k.jpg"),roughnessMap:e.load("/threejs-practices/textures/textures/grave/lichen_rock_1k/grave_arm_1k.jpg"),metalnessMap:e.load("/threejs-practices/textures/textures/grave/lichen_rock_1k/grave_arm_1k.jpg"),normalMap:e.load("/threejs-practices/textures/textures/grave/lichen_rock_1k/grave_nor_gl_1k.jpg")})}_createGraves(){let e=new r.ZAu;return Array.from({length:this._config.numOfGraves},()=>{let t=this._createGraveMesh();e.add(t)}),e}_createGraveMesh(){let{minBoundaryRadius:e,maxBoundaryRadius:t,geometry:o,material:n}=this._config,a=e+Math.random()*(t-e),i=2*Math.PI*Math.random(),s=new r.Kj0(o,n);return s.castShadow=!0,s.receiveShadow=!0,s.position.x=Math.cos(i)*a,s.position.y=.5*Math.random(),s.position.z=Math.sin(i)*a,s.rotation.x=Math.PI*(10/180)*(2*Math.random()-1),s}get mesh(){return this._group}constructor(e){this._config={numOfGraves:30,minBoundaryRadius:5,maxBoundaryRadius:8,geometry:null,material:null},this._textureLoader=e,this._config.geometry=this._createGeometry(),this._config.material=this._createMaterial(e),this._group=this._createGraves()}};let Sky=class Sky extends r.Kj0{constructor(){let e=Sky.SkyShader,t=new r.jyz({name:e.name,uniforms:r.rDY.clone(e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:r._Li,depthWrite:!1});super(new r.DvJ(1,1,1),t),this.isSky=!0}};Sky.SkyShader={name:"SkyShader",uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new r.Pa4},up:{value:new r.Pa4(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPosition );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};let SkyEnvironment=class SkyEnvironment{get mesh(){return this._mesh}constructor(){let e=new Sky;e.scale.setScalar(45e4);let t=r.M8C.degToRad(90),o=r.M8C.degToRad(180),n=new r.Pa4().setFromSphericalCoords(1,t,o);e.material.uniforms.sunPosition.value=n,this._mesh=e}};let Ghosts=class Ghosts{_createGhosts(){let e=new r.ZAu;return e.add(this._createGhost1()),e.add(this._createGhost2()),e.add(this._createGhost3()),e}_createGhost1(){let e=new r.cek("#ff1493",7);return e.name="ghost1",e.castShadow=!0,e}_createGhost2(){let e=new r.cek("#03a9f4",7);return e.name="ghost2",e.castShadow=!0,e}_createGhost3(){let e=new r.cek("#00ff00",7);return e.name="ghost3",e.castShadow=!0,e}animateGhosts(e){let t=.5*e;this.ghost1.position.x=5*Math.cos(t),this.ghost1.position.y=Math.sin(t)*Math.sin(2.34*t)+.5,this.ghost1.position.z=5*Math.sin(t);let o=-.5*e;this.ghost2.position.x=6*Math.cos(o),this.ghost2.position.y=Math.sin(o)*Math.sin(5.5*o),this.ghost2.position.z=6*Math.sin(o);let n=.3*e;this.ghost3.position.x=7*Math.cos(n),this.ghost3.position.y=Math.sin(n)*Math.sin(n),this.ghost3.position.z=7*Math.sin(n)}get mesh(){return this._group}get ghost1(){return this._group.getObjectByName("ghost1")}get ghost2(){return this._group.getObjectByName("ghost2")}get ghost3(){return this._group.getObjectByName("ghost3")}constructor(){this._group=this._createGhosts()}};let HauntedHouseWegGL=class HauntedHouseWegGL{_resize(){let{_$parent:e,_renderer:t,_camera:o}=this;this._config.resizeTimeoutId&&window.clearTimeout(this._config.resizeTimeoutId),this._config.resizeTimeoutId=setTimeout(()=>{let{width:n,height:a}=e.getBoundingClientRect();t.pixelRatio=Math.min(window.devicePixelRatio,2),t.setSize(n,a),o.aspect=n/a,o.updateProjectionMatrix(),this._config.resizeTimeoutId=null},500)}_initResize(){window.addEventListener("resize",this._resize.bind(this))}_createMainLight(){let e=new MainLight;return this._scene.add(e.ambientLight),this._scene.add(e.directionalLight),e}_createFloor(){let e=new Floor(this._textureLoader);return this._scene.add(e.mesh),e}_createHouse(){let e=new House(this._textureLoader);return e.mesh.position.set(0,1.25,0),this._scene.add(e.mesh),e}_createGraves(){let e=new Graves(this._textureLoader);return this._scene.add(e.mesh),e}_createSkyEnvironment(){let e=new SkyEnvironment;return this._scene.add(e.mesh),e}_createGhosts(){let e=new Ghosts;return this._scene.add(e.mesh),e}tick(){window.requestAnimationFrame(this.tick.bind(this));let e=this._timer.getElapsed();this._ghosts.animateGhosts(e),this._timer.update(),this._controls.update(),this._renderer.render(this._scene,this._camera)}run(){this.tick()}dispose(){window.removeEventListener("resize",this._initResize)}constructor(e){if(!(null==e?void 0:e.parentElement))throw Error("can not access parentElement");this._$parent=e.parentElement;let{width:t,height:o}=e.parentElement.getBoundingClientRect();this._config={size:{width:t,height:o},resizeTimeoutId:null},this._scene=new r.xsS,this._scene.background=new r.Ilk("#000");let n=new r.cPb;n.fov=45,n.aspect=t/o,n.near=1,n.far=2e3,n.position.set(7,5,15),n.lookAt(0,0,0),n.updateProjectionMatrix(),this._camera=n;let a=new OrbitControls(n,e);a.enableDamping=!0,this._controls=a,this._timer=new Timer;let i=new r.CP7({canvas:e});i.pixelRatio=Math.min(window.devicePixelRatio,2),i.setSize(t,o),i.shadowMap.enabled=!0,this._renderer=i,this._initResize(),this._textureLoader=new r.dpR,this._mainLight=this._createMainLight(),this._floor=this._createFloor(),this._house=this._createHouse(),this._graves=this._createGraves(),this._skyEnvironment=this._createSkyEnvironment(),this._ghosts=this._createGhosts()}};var p=o(802);function _templateObject(){let e=(0,n._)(["\n    width: 100%;\n    height: 100%;\n\n    overflow: hidden;\n"]);return _templateObject=function(){return e},e}let m=p.ZP.div.withConfig({componentId:"sc-ff4380b5-0"})(_templateObject());var HauntedHouse_HauntedHouse=function(){let e=(0,i.useRef)(null),t=(0,i.useRef)(null);return(0,i.useEffect)(function(){return e.current&&(t.current=new HauntedHouseWegGL(e.current),t.current.run()),()=>{var e;null===(e=t.current)||void 0===e||e.dispose()}},[]),(0,a.jsx)(m,{children:(0,a.jsx)("canvas",{ref:e})})}}},function(e){e.O(0,[689,576,971,472,744],function(){return e(e.s=2576)}),_N_E=e.O()}]);