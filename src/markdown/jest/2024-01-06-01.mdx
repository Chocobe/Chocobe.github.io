---
id: 4
title: 'Nextjs μ useRouter mock μ •μν•κΈ°'
description: 'Nextjs μ useRouter λ¥Ό μ‚¬μ©ν•λ” μ»΄ν¬λ„νΈλ¥Ό ν…μ¤νΈν•κΈ° μ„ν• λ°©λ²•μ„ μ •λ¦¬ν•©λ‹λ‹¤.'
thumbnail: https://image.dongascience.com/Photo/2020/03/5bddba7b6574b95d37b6079c199d7101.jpg

featured: false
tags: [
    'jest',
    '@testing-library',
    'useRouter',
    'next-router-mock',
    'μ λ‹› ν…μ¤νΈ',
]

createdAt: '2024-01-06 17:30:00'
modifiedHistories: []
---

# Nextjs μ useRouter mock μ •μν•κΈ°

νμ΄μ§€ μ΄λ™μ„ μ„ν• μ»΄ν¬λ„νΈλ” μ›Ήνμ΄μ§€μ—μ„ λΉ μ§ μ μ—†λ” μ»΄ν¬λ„νΈ μ…λ‹λ‹¤.

Nextjs ν”„λ΅μ νΈμ—μ„ νμ΄μ§€ μ΄λ™μ€ Nextjs μ `useRouter` hook μ„ μ‚¬μ©ν•μ—¬ κµ¬ν„ν•©λ‹λ‹¤.

μ΄λ¬ν• μ»΄ν¬λ„νΈλ” λ‚΄λ¶€μ—μ„ `useRouter` λ¥Ό μ‚¬μ©ν•κ³  μκΈ° λ•λ¬Έμ—, Jest μ `render()` λ¥Ό μ‚¬μ©ν• λ λ”λ§ μ‹, μ—λ¬κ°€ λ°μƒν•κ² λ©λ‹λ‹¤.

μ΄λ² ν¬μ¤ν…μ—μ„λ” `useRouter` λ¥Ό mocking ν•μ—¬ ν…μ¤νΈ ν•λ” λ°©λ²•μ— λ€ν•΄ μ •λ¦¬ν•κ³ μ ν•©λ‹λ‹¤.



<br />



## μ»΄ν¬λ„νΈ λ λ”λ§ μ‹¤ν¨

`useRouter` λ¥Ό μ‚¬μ©ν•λ” μ»΄ν¬λ„νΈλ¥Ό μ•„λ¬΄λ° μ„¤μ •μ—†μ΄ Jest μ `render()` λ¥Ό μ‹¤ν–‰μ‹ν‚¤λ©΄, λ λ”λ§ μ—λ¬κ°€ λ°μƒν•©λ‹λ‹¤.

μ΄λ” ν…μ¤νΈ ν™κ²½μ—μ„ `useRouter()` κ°€ λ λ”λ§ λμ§€ μ•μΌλ©΄μ„ λ°μƒν•κ² λ©λ‹λ‹¤.

μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄, `next-router-mock` λΌμ΄λΈλ¬λ¦¬λ¥Ό ν™μ©ν•  μ μμµλ‹λ‹¤.

```bash
yarn add -D next-router-mock
```



<br />



## `useRouter` λ¥Ό μ‚¬μ©ν•λ” ν…μ¤νΈμ© μ»΄ν¬λ„νΈ

μ΄λ² ν¬μ¤νΈμ—μ„ ν…μ¤νΈν•  μ»΄ν¬λ„νΈλ” μ•„λμ™€ κ°™μµλ‹λ‹¤.

`onClick()` λ‚΄λ¶€μ—μ„ `router.push()` λ¥Ό μ‚¬μ©ν•μ—¬ νμ΄μ§€λ¥Ό μ΄λ™ μ‹ν‚¤λ” λ™μ‘μ„ ν•©λ‹λ‹¤.

```tsx title="MyAnchor.tsx" showLineNumbers
import {
    useCallback,
    PropsWithChildren,
} from 'react';
import {
    useRouter,
} from 'next/navigation';

type TMyAnchorProps = PropsWithChildren<{
    className?: string;
    href: string;
}>;

function MyAnchor(props: TMyAnchorProps) {
    const {
        className,
        href,
        children,
    } = props;

    const router = useRouter();

    const onClick = useCallback(() => {
        router.push(href);
    }, [href]);

    return (
        <a 
            className={className}
            href={href}>
            {children}
        </a>
    );
}

export default MyAnchor;
```



<br />



## `jest.mock()` μ„ μ‚¬μ©ν•μ—¬ `useRouter()` mocking ν•κΈ°

`jest.mock()` μ„ μ‚¬μ©ν•λ©΄, νΉμ • λ¨λ“μ„ mocking ν•  μ μμµλ‹λ‹¤.

μ΄λ¥Ό ν™μ©ν•μ—¬, `next/navigation` λ¨λ“μ„ mocking ν•μ—¬ `useRouter` κ°€ ν…μ¤νΈ ν™κ²½μ—μ„ λ λ”λ§λ  μ μλ„λ΅ ν•©λ‹λ‹¤.

```ts title="jest.mock() μΌλ΅ useRouter mocking ν•κΈ°"
jest.mock('next/navigation', () => jest.requireActual('next-router-mock'));
```

* `jest.mock()`: νΉμ • λ¨λ“μ„ mocking ν•©λ‹λ‹¤.
    * μ²«λ²μ§Έ μΈμ: mocking ν•  λ¨λ“λ…
    * λ‘λ²μ§Έ μΈμ: mocking λ°ν™ ν•¨μ
* `jest.requireActual()`: μ‹¤μ  λ¨λ“μ„ κ°€μ Έμµλ‹λ‹¤. (`import`, `require`)

<br />

μ„ μ½”λ“λ¥Ό μ‚¬μ©ν•μ—¬ `useRouter` λ¥Ό mocking ν•κ² λλ©΄, μ •μƒμ μΌλ΅ λ λ”λ§λ¨μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

μ•„λλ” ν…μ¤νΈ μμ‹ μ½”λ“ μ…λ‹λ‹¤.

```tsx title="MyAnchor ν…μ¤νΈ" showLineNumbers {7, 9, 12-15, 48-50}
import MyAnchor from './MyAnchor';
import {
    render,
    screen,
} from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import mockRouter from 'next-router-mock';

jest.mock('next/navigation', () => jest.requireActual('next-router-mock'));

describe('<MyAnchor /> ν…μ¤νΈ', () => {
    beforeEach(() => {
        // mockRouter μ pathname μ„ '/' μΌλ΅ μ΄κΈ°ν™” ν•©λ‹λ‹¤.
        mockRouter.push('/');
    });

    it('DOM μ— λ λ”λ§ λλ‹¤.', () => {
        render(
            <div data-testid="test-MyAnchor">
                <MyAnchor href="/test-url">
                    Test Page
                </MyAnchor>
            </div>
        );

        const $anchor = screen.getByTestId('test-MyAnchor');

        expect($anchor).toBeInTheDocument();
    });

    it('click μ‹, href κ²½λ΅λ΅ νμ΄μ§€ μ΄λ™ν•λ‹¤.', async () => {
        render(
            <div data-testid="test-MyAnchor">
                <MyAnchor 
                    className="test-className"
                    href="test-url">
                    Test Page
                </MyAnchor>
            </div>
        );

        const $anchor = screen
            .getByTestId('test-MyAnchor')
            .querySelector('.test-className');

        await userEvent.click($anchor);

        expect(mockRouter).toMatchObject({
            pathname: '/test-url',
        });
    });
});
```

<br />

κ·Έλ¦¬κ³  `router` κ°€ ν΄λ¦­λ ν›„, νμ΄μ§€ μ΄λ™μ΄ λμ—λ”μ§€ ν…μ¤νΈν•κΈ° μ„ν•΄, `mockRouter` λ¥Ό ν™μ©ν•  μ μμµλ‹λ‹¤.

`mockRouter` μ `pathname` μ— μ΄λ™ν•  νμ΄μ§€μ url μ΄ λ°μλμ—λ‹¤λ©΄, μ‹¤μ λ΅λ” νμ΄μ§€ μ΄λ™μ΄ λ κ²ƒμΌλ΅ λ³Ό μ μμµλ‹λ‹¤.



<br />



## λ§μΉλ©°

ν”„λ μ„μ›ν¬λ” κ°λ°μ— ν•„μ”ν• λ‹¤μ–‘ν• κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤.

μ΄λ¥Ό ν…μ¤νΈν•κΈ° μ„ν•΄μ„λ” ν”„λ μ„μ›ν¬μ™€ λ™μΌν• ν™κ²½μ„ λ§λ“¤μ–΄μ£Όμ–΄μ•Ό ν•¨μ„ μ•κ² λμ—μµλ‹λ‹¤.

λ‹¨μ μ»΄ν¬λ„νΈλ‚ ν•¨μλ¥Ό ν…μ¤νΈν•  λ•λ” μ‹ κ²½μ“°μ§€ μ•μ•λ **λ¨λ“ mocking** μ΄ ν•„μ”ν•κ³ , `jest.mock()` μ„ μ‚¬μ©ν•μ—¬ mocking ν•  μ μμ—μµλ‹λ‹¤.

`next-router-mock` λΌμ΄λΈλ¬λ¦¬ μ²λΌ μ¤ν” μ†μ¤ λ¬Έν™”κ°€ μκΈ°μ— μ €λ„ μ›Ή κ°λ°μ„ ν•  μ μμμ„ μƒμ‚Ό λλΌκ² λ©λ‹λ‹¤. π« 
